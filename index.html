<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite + Vue + TS</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.ts"></script>

    <script>
      window.sessionStorage.removeItem("reservationWidgetState");

      document.addEventListener("DOMContentLoaded", function () {
        (function (document, tagName, scriptId) {
          const firstScript = document.getElementsByTagName(tagName)[0];
          if (document.getElementById(scriptId)) return;

          const widgetData = document.querySelector(".widget-data");
          const restoId = widgetData?.getAttribute("restoId") || "default";
          const color = widgetData?.getAttribute("color") || "default";

          const scriptElement = document.createElement(tagName);
          scriptElement.src = "https://itsdimitrie.github.io/table.one-widget-test/embed.js";

          const widgetContainer = document.createElement("div");
          widgetContainer.className = "reservation-widget";

          widgetContainer.setAttribute("data-restaurant", restoId);
          widgetContainer.setAttribute("data-color", color);

          document.body.appendChild(widgetContainer);
          firstScript.parentNode?.insertBefore(scriptElement, firstScript);
        })(document, "script", "reservationWidgetScript");
      });
    </script>
    
    <div class="widget-data" restoId="Bistro Dimitrie" color="red"></div>
  </body>
</html>
